// Prisma schema for Worship Song Manager
// SQLite is simple to run locally and on most hosts.

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Song {
  id             Int           @id @default(autoincrement())
  title          String
  artist         String
  key            String?       @map("songKey")
  tags           String?       // Comma-separated tags/categories
  lyricsText     String?
  lyricsUrl      String?
  lastPlayedDate DateTime?
  playCount      Int           @default(0)
  notes          String?
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt

  serviceSongs   ServiceSong[]
}

model Service {
  id           Int           @id @default(autoincrement())
  date         DateTime
  notes        String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  serviceSongs ServiceSong[]
}

// Join table between Service and Song, to track which songs were used
// in which service, and in which order.
model ServiceSong {
  id        Int     @id @default(autoincrement())
  service   Service @relation(fields: [serviceId], references: [id])
  serviceId Int
  song      Song    @relation(fields: [songId], references: [id])
  songId    Int

  order     Int?    // Optional order of the song within the service
}
